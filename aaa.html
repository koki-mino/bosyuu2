<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­å­¦ç”Ÿãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ã‚¢ãƒ—ãƒªã€€ãƒ†ã‚¹ãƒˆã‚µã‚¤ãƒˆ</title>
    <!-- Tailwind CSS CDNã‚’èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwindã®è¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-gray-800">ã€ãƒ†ã‚¹ãƒˆã€‘ä¸­ãƒœãƒ©å¤§å‹Ÿé›†ï¼</h1>
            <nav>
                <button id="studentViewBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-300">ä¸­å­¦ç”Ÿå‘ã‘ãƒšãƒ¼ã‚¸</button>
                <button id="organizerLoginBtn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-300 ml-4">ä¸»å‚¬è€…ãƒ­ã‚°ã‚¤ãƒ³</button>
                <button id="organizerLogoutBtn" class="hidden bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-300 ml-4">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8">

        <!-- ä¸­å­¦ç”Ÿå‘ã‘ãƒšãƒ¼ã‚¸ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤º) -->
        <div id="studentView" class="view">
            <h2 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">å‹Ÿé›†ä¸­ã®ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ä¸€è¦§</h2>
            <div id="eventListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- ã‚¤ãƒ™ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«å‹•çš„ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
            </div>
            <p id="noEventsMessageStudent" class="hidden text-center text-gray-500 text-lg mt-12">ç¾åœ¨ã€å‹Ÿé›†ä¸­ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        </div>

        <!-- ä¸»å‚¬è€…ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ -->
        <div id="organizerLoginView" class="hidden view">
            <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">ä¸»å‚¬è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
                <form id="loginForm">
                    <div class="mb-4">
                        <label for="organizerId" class="block text-gray-700 font-bold mb-2">ID</label>
                        <input type="text" id="organizerId" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
                    </div>
                    <div class="mb-6">
                        <label for="organizerPassword" class="block text-gray-700 font-bold mb-2">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                        <input type="password" id="organizerPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
                    </div>
                    <p id="loginError" class="hidden text-red-500 text-sm mb-4">IDã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚</p>
                    <button type="submit" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-full transition-colors duration-300">ãƒ­ã‚°ã‚¤ãƒ³</button>
                </form>
            </div>
        </div>

        <!-- ä¸»å‚¬è€…ãƒšãƒ¼ã‚¸ (ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†) -->
        <div id="organizerView" class="hidden view">
            <h2 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†</h2>
            
            <div class="bg-white p-8 rounded-xl shadow-lg mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">æ–°è¦ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²</h3>
                <form id="eventForm">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="organizerName" class="block text-gray-700 font-bold mb-2">ä¸»å‚¬è€…å</label>
                            <input type="text" id="organizerName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="eventName" class="block text-gray-700 font-bold mb-2">ã‚¤ãƒ™ãƒ³ãƒˆå</label>
                            <input type="text" id="eventName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="eventDate" class="block text-gray-700 font-bold mb-2">æ—¥ç¨‹</label>
                            <input type="date" id="eventDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="eventLocation" class="block text-gray-700 font-bold mb-2">å ´æ‰€</label>
                            <input type="text" id="eventLocation" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="meetingTime" class="block text-gray-700 font-bold mb-2">é›†åˆæ™‚é–“</label>
                            <input type="time" id="meetingTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="dissolutionTime" class="block text-gray-700 font-bold mb-2">è§£æ•£æ™‚é–“</label>
                            <input type="time" id="dissolutionTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="targetSchools" class="block text-gray-700 font-bold mb-2">å¯¾è±¡ã®ä¸­å­¦æ ¡</label>
                        <input type="text" id="targetSchools" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="itemsToBring" class="block text-gray-700 font-bold mb-2">æŒã¡ç‰©</label>
                        <input type="text" id="itemsToBring" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="dressCode" class="block text-gray-700 font-bold mb-2">æœè£…</label>
                        <input type="text" id="dressCode" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="otherNotes" class="block text-gray-700 font-bold mb-2">ãã®ä»–é€£çµ¡äº‹é …</label>
                        <textarea id="otherNotes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                    </div>
                    <div class="mb-6">
                        <label for="recruitmentUrl" class="block text-gray-700 font-bold mb-2">å‹Ÿé›†ç”¨URL</label>
                        <input type="url" id="recruitmentUrl" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-full transition-colors duration-300">ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™»éŒ²</button>
                </form>
            </div>

            <!-- ç™»éŒ²æ¸ˆã¿ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ -->
            <div class="bg-white p-8 rounded-xl shadow-lg">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">ç™»éŒ²æ¸ˆã¿ã‚¤ãƒ™ãƒ³ãƒˆ</h3>
                <div id="organizerEventListContainer" class="overflow-x-auto">
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead>
                            <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                                <th class="py-3 px-6 text-left">ã‚¤ãƒ™ãƒ³ãƒˆå</th>
                                <th class="py-3 px-6 text-left">æ—¥ç¨‹</th>
                                <th class="py-3 px-6 text-center">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                            </tr>
                        </thead>
                        <tbody id="organizerEventList" class="text-gray-600 text-sm font-light">
                            <!-- ç™»éŒ²æ¸ˆã¿ã‚¤ãƒ™ãƒ³ãƒˆãŒã“ã“ã«å‹•çš„ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
                        </tbody>
                    </table>
                </div>
                <p id="noEventsMessageOrganizer" class="hidden text-center text-gray-500 text-lg mt-4">ç¾åœ¨ã€ã‚¤ãƒ™ãƒ³ãƒˆã¯ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
            </div>
        </div>

        <!-- ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ« (ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ä»£æ›¿) -->
        <div id="customModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white p-6 rounded-lg shadow-xl w-80">
                <p id="modalMessage" class="text-center text-lg font-semibold mb-4">æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
                <div class="flex justify-center space-x-4">
                    <button id="modalConfirmBtn" class="bg-red-500 text-white py-2 px-4 rounded-full hover:bg-red-600">å‰Šé™¤</button>
                    <button id="modalCancelBtn" class="bg-gray-300 text-gray-800 py-2 px-4 rounded-full hover:bg-gray-400">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                </div>
            </div>
        </div>

        <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
        <div id="editModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div class="bg-white p-8 rounded-xl shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç·¨é›†</h3>
                <form id="editEventForm">
                    <input type="hidden" id="editEventId">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="editOrganizerName" class="block text-gray-700 font-bold mb-2">ä¸»å‚¬è€…å</label>
                            <input type="text" id="editOrganizerName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="editEventName" class="block text-gray-700 font-bold mb-2">ã‚¤ãƒ™ãƒ³ãƒˆå</label>
                            <input type="text" id="editEventName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="editEventDate" class="block text-gray-700 font-bold mb-2">æ—¥ç¨‹</label>
                            <input type="date" id="editEventDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="editEventLocation" class="block text-gray-700 font-bold mb-2">å ´æ‰€</label>
                            <input type="text" id="editEventLocation" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="editMeetingTime" class="block text-gray-700 font-bold mb-2">é›†åˆæ™‚é–“</label>
                            <input type="time" id="editMeetingTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="editDissolutionTime" class="block text-gray-700 font-bold mb-2">è§£æ•£æ™‚é–“</label>
                            <input type="time" id="editDissolutionTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="editTargetSchools" class="block text-gray-700 font-bold mb-2">å¯¾è±¡ã®ä¸­å­¦æ ¡</label>
                        <input type="text" id="editTargetSchools" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="editItemsToBring" class="block text-gray-700 font-bold mb-2">æŒã¡ç‰©</label>
                        <input type="text" id="editItemsToBring" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="editDressCode" class="block text-gray-700 font-bold mb-2">æœè£…</label>
                        <input type="text" id="editDressCode" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="mb-4">
                        <label for="editOtherNotes" class="block text-gray-700 font-bold mb-2">ãã®ä»–é€£çµ¡äº‹é …</label>
                        <textarea id="editOtherNotes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                    </div>
                    <div class="mb-6">
                        <label for="editRecruitmentUrl" class="block text-gray-700 font-bold mb-2">å‹Ÿé›†ç”¨URL</label>
                        <input type="url" id="editRecruitmentUrl" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="closeEditModalBtn" class="bg-gray-300 text-gray-800 font-bold py-3 px-4 rounded-full hover:bg-gray-400">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                        <button type="submit" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-full transition-colors duration-300">æ›´æ–°</button>
                    </div>
                </form>
            </div>
        </div>

    </main>

    <footer class="bg-gray-800 text-white text-center py-4 mt-8">
        <div class="container mx-auto px-4">
            <p>&copy; 2024 ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢ã‚¢ãƒ—ãƒª. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
    // ã“ã“ã«GASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„
    const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwisetZ-d0rxInvJrxuBAdYkv_9MNRAZZdsGllbTfTNftQ8rqLeeUxywJnV7-ok1rsS/exec';

    // ä¸»å‚¬è€…ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±
    const ORGANIZER_ID = 'ikuseikai';
    const ORGANIZER_PASSWORD = 'ringodaisuki';

    // DOMè¦ç´ ã®å–å¾—
    const studentView = document.getElementById('studentView');
    const organizerLoginView = document.getElementById('organizerLoginView');
    const organizerView = document.getElementById('organizerView');
    const eventListContainer = document.getElementById('eventListContainer');
    const organizerEventList = document.getElementById('organizerEventList');
    const eventForm = document.getElementById('eventForm');
    const loginForm = document.getElementById('loginForm');
    const organizerLoginBtn = document.getElementById('organizerLoginBtn');
    const organizerLogoutBtn = document.getElementById('organizerLogoutBtn');
    const studentViewBtn = document.getElementById('studentViewBtn');
    const noEventsMessageStudent = document.getElementById('noEventsMessageStudent');
    const noEventsMessageOrganizer = document.getElementById('noEventsMessageOrganizer');
    const customModal = document.getElementById('customModal');
    const modalConfirmBtn = document.getElementById('modalConfirmBtn');
    const modalCancelBtn = document.getElementById('modalCancelBtn');
    const editModal = document.getElementById('editModal');
    const editEventForm = document.getElementById('editEventForm');
    const closeEditModalBtn = document.getElementById('closeEditModalBtn');

    // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ç®¡ç†
    let isLoggedIn = false;
    let eventToDeleteId = null; // å‰Šé™¤ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã®IDã‚’ä¸€æ™‚çš„ã«ä¿æŒ

    // ãƒ“ãƒ¥ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
    function showView(viewId) {
        document.querySelectorAll('.view').forEach(view => {
            view.classList.add('hidden');
        });
        document.getElementById(viewId).classList.remove('hidden');
    }

    // APIã‚’é€šã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹
    async function fetchEvents() {
        try {
            const response = await fetch(GAS_WEB_APP_URL);
            if (!response.ok) throw new Error('Network response was not ok');
            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Failed to fetch events:', error);
            return [];
        }
    }

    // APIã‚’é€šã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹
    async function postEventData(payload) {
        try {
            const response = await fetch(GAS_WEB_APP_URL, {
                method: 'POST',
                body: JSON.stringify(payload),
                headers: {
                    'Content-Type': 'application/json',
                },
            });
            return await response.json();
        } catch (error) {
            console.error('Failed to post data:', error);
            return { status: 'error' };
        }
    }

    // ä¸­å­¦ç”Ÿå‘ã‘ãƒšãƒ¼ã‚¸ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
    async function renderStudentEvents() {
        const events = await fetchEvents();
        eventListContainer.innerHTML = '';
        if (events.length === 0) {
            noEventsMessageStudent.classList.remove('hidden');
        } else {
            noEventsMessageStudent.classList.add('hidden');
            events.forEach(event => {
                const eventCard = `
                    <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-300">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">${event.eventName || 'ã‚¤ãƒ™ãƒ³ãƒˆåãªã—'}</h3>
                        <p class="text-gray-600 mb-1">ğŸ“… ${event.eventDate || 'æ—¥ç¨‹æœªå®š'}</p>
                        <p class="text-gray-600 mb-4">ğŸ“ ${event.eventLocation || 'å ´æ‰€æœªå®š'}</p>
                        <p class="text-gray-500 mb-4 text-sm">${event.otherNotes ? event.otherNotes.substring(0, 100) + '...' : ''}</p>
                        <button onclick="showEventDetails('${event.id}')" class="bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-full mr-2 hover:bg-gray-300">è©³ç´°ã‚’è¦‹ã‚‹</button>
                        ${event.recruitmentUrl ? `<a href="${event.recruitmentUrl}" target="_blank" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full inline-block">ç”³ã—è¾¼ã‚€</a>` : ''}
                    </div>
                `;
                eventListContainer.innerHTML += eventCard;
            });
        }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°ã‚’ãƒ¢ãƒ¼ãƒ€ãƒ«ã§è¡¨ç¤ºã™ã‚‹
    async function showEventDetails(id) {
        const events = await fetchEvents();
        const event = events.find(e => e.id === id);
        if (!event) return;
        const detailsHtml = `
            <div id="tempModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div class="bg-white p-8 rounded-xl shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto relative">
                    <button onclick="document.getElementById('tempModal').remove()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
                    <h3 class="text-3xl font-extrabold text-gray-800 mb-4">${event.eventName || 'ã‚¤ãƒ™ãƒ³ãƒˆåãªã—'}</h3>
                    <p class="text-gray-600 mb-2"><strong>ä¸»å‚¬è€…:</strong> ${event.organizerName || 'ä¸»å‚¬è€…åãªã—'}</p>
                    <p class="text-gray-600 mb-2"><strong>æ—¥ç¨‹:</strong> ${event.eventDate || 'æ—¥ç¨‹æœªå®š'}</p>
                    <p class="text-gray-600 mb-2"><strong>å ´æ‰€:</strong> ${event.eventLocation || 'æœªå®š'}</p>
                    <p class="text-gray-600 mb-2"><strong>é›†åˆæ™‚é–“:</strong> ${event.meetingTime || 'æœªå®š'}</p>
                    <p class="text-gray-600 mb-2"><strong>è§£æ•£æ™‚é–“:</strong> ${event.dissolutionTime || 'æœªå®š'}</p>
                    <p class="text-gray-600 mb-2"><strong>å¯¾è±¡ã®ä¸­å­¦æ ¡:</strong> ${event.targetSchools || 'ã™ã¹ã¦ã®å­¦æ ¡'}</p>
                    <p class="text-gray-600 mb-2"><strong>æŒã¡ç‰©:</strong> ${event.itemsToBring || 'ç‰¹ã«ãªã—'}</p>
                    <p class="text-gray-600 mb-2"><strong>æœè£…:</strong> ${event.dressCode || 'è‡ªç”±'}</p>
                    <p class="text-gray-600 mb-4"><strong>ãã®ä»–é€£çµ¡äº‹é …:</strong> ${event.otherNotes || 'ç‰¹ã«ãªã—'}</p>
                    ${event.recruitmentUrl ? `<a href="${event.recruitmentUrl}" target="_blank" class="w-full text-center block bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-full transition-colors duration-300">ç”³ã—è¾¼ã‚€</a>` : ''}
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', detailsHtml);
    }

    // ä¸»å‚¬è€…å‘ã‘ãƒšãƒ¼ã‚¸ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
    async function renderOrganizerEvents() {
        const events = await fetchEvents();
        organizerEventList.innerHTML = '';
        if (events.length === 0) {
            noEventsMessageOrganizer.classList.remove('hidden');
        } else {
            noEventsMessageOrganizer.classList.add('hidden');
            events.forEach(event => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-100';
                row.innerHTML = `
                    <td class="py-3 px-6 text-left whitespace-nowrap">${event.eventName || 'ã‚¤ãƒ™ãƒ³ãƒˆåãªã—'}</td>
                    <td class="py-3 px-6 text-left">${event.eventDate || 'æ—¥ç¨‹æœªå®š'}</td>
                    <td class="py-3 px-6 text-center">
                        <button onclick="editEvent('${event.id}')" class="bg-indigo-500 text-white py-1 px-3 rounded-full text-xs hover:bg-indigo-600 mr-2">ç·¨é›†</button>
                        <button onclick="showDeleteModal('${event.id}')" class="bg-red-500 text-white py-1 px-3 rounded-full text-xs hover:bg-red-600">å‰Šé™¤</button>
                    </td>
                `;
                organizerEventList.appendChild(row);
            });
        }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡å‡¦ç†
    eventForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const newEvent = {
            organizerName: document.getElementById('organizerName').value,
            eventName: document.getElementById('eventName').value,
            eventDate: document.getElementById('eventDate').value,
            eventLocation: document.getElementById('eventLocation').value,
            meetingTime: document.getElementById('meetingTime').value,
            dissolutionTime: document.getElementById('dissolutionTime').value,
            targetSchools: document.getElementById('targetSchools').value,
            itemsToBring: document.getElementById('itemsToBring').value,
            dressCode: document.getElementById('dressCode').value,
            otherNotes: document.getElementById('otherNotes').value,
            recruitmentUrl: document.getElementById('recruitmentUrl').value,
        };
        const result = await postEventData({ action: 'add', event: newEvent });
        if (result.status === 'success') {
            eventForm.reset();
            renderOrganizerEvents();
            renderStudentEvents();
        } else {
            alert('ã‚¤ãƒ™ãƒ³ãƒˆã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
        }
    });

    // ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡å‡¦ç†
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const id = document.getElementById('organizerId').value;
        const password = document.getElementById('organizerPassword').value;
        const loginError = document.getElementById('loginError');
        if (id === ORGANIZER_ID && password === ORGANIZER_PASSWORD) {
            isLoggedIn = true;
            loginError.classList.add('hidden');
            showView('organizerView');
            organizerLoginBtn.classList.add('hidden');
            organizerLogoutBtn.classList.remove('hidden');
            renderOrganizerEvents();
        } else {
            loginError.classList.remove('hidden');
        }
    });

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
    organizerLogoutBtn.addEventListener('click', () => {
        isLoggedIn = false;
        showView('studentView');
        organizerLoginBtn.classList.remove('hidden');
        organizerLogoutBtn.classList.add('hidden');
        renderStudentEvents();
    });

    // ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    studentViewBtn.addEventListener('click', () => {
        showView('studentView');
        renderStudentEvents();
    });

    organizerLoginBtn.addEventListener('click', () => {
        showView('organizerLoginView');
    });

    // å‰Šé™¤ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹
    function showDeleteModal(id) {
        eventToDeleteId = id;
        customModal.classList.remove('hidden');
    }

    // å‰Šé™¤ã‚’å®Ÿè¡Œã™ã‚‹
    modalConfirmBtn.addEventListener('click', async () => {
        const result = await postEventData({ action: 'delete', id: eventToDeleteId });
        if (result.status === 'success') {
            renderOrganizerEvents();
            renderStudentEvents();
        } else {
            alert('ã‚¤ãƒ™ãƒ³ãƒˆã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
        }
        customModal.classList.add('hidden');
    });

    // å‰Šé™¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹
    modalCancelBtn.addEventListener('click', () => {
        customModal.classList.add('hidden');
    });

    // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
    async function editEvent(id) {
        const events = await fetchEvents();
        const event = events.find(e => e.id === id);
        if (!event) return;

        document.getElementById('editEventId').value = event.id;
        document.getElementById('editOrganizerName').value = event.organizerName;
        document.getElementById('editEventName').value = event.eventName;
        document.getElementById('editEventDate').value = event.eventDate;
        document.getElementById('editEventLocation').value = event.eventLocation;
        document.getElementById('editMeetingTime').value = event.meetingTime;
        document.getElementById('editDissolutionTime').value = event.dissolutionTime;
        document.getElementById('editTargetSchools').value = event.targetSchools;
        document.getElementById('editItemsToBring').value = event.itemsToBring;
        document.getElementById('editDressCode').value = event.dressCode;
        document.getElementById('editOtherNotes').value = event.otherNotes;
        document.getElementById('editRecruitmentUrl').value = event.recruitmentUrl;

        editModal.classList.remove('hidden');
    }

    // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡å‡¦ç†
    editEventForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const eventId = document.getElementById('editEventId').value;
        const updatedEvent = {
            id: eventId,
            organizerName: document.getElementById('editOrganizerName').value,
            eventName: document.getElementById('editEventName').value,
            eventDate: document.getElementById('editEventDate').value,
            eventLocation: document.getElementById('editEventLocation').value,
            meetingTime: document.getElementById('editMeetingTime').value,
            dissolutionTime: document.getElementById('editDissolutionTime').value,
            targetSchools: document.getElementById('editTargetSchools').value,
            itemsToBring: document.getElementById('editItemsToBring').value,
            dressCode: document.getElementById('editDressCode').value,
            otherNotes: document.getElementById('editOtherNotes').value,
            recruitmentUrl: document.getElementById('editRecruitmentUrl').value,
        };

        const result = await postEventData({ action: 'update', event: updatedEvent });
        if (result.status === 'success') {
            renderOrganizerEvents();
            renderStudentEvents();
            editModal.classList.add('hidden');
        } else {
            alert('ã‚¤ãƒ™ãƒ³ãƒˆã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
        }
    });

    // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    closeEditModalBtn.addEventListener('click', () => {
        editModal.classList.add('hidden');
    });

    // åˆæœŸåŒ–å‡¦ç†
    async function initializeApp() {
        // ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦è¡¨ç¤º
        renderStudentEvents();
        showView('studentView');
    }

    // ã‚¢ãƒ—ãƒªã‚’åˆæœŸåŒ–
    initializeApp();
    </script>
</body>
</html>


